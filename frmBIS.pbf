;
; This code is automatically generated by the FormDesigner.
; Manual modification is possible to adjust existing commands, but anything else will be dropped when the code is compiled.
; Event procedures needs to be put in another source file.
;

Global wndMain

Global lblTitle, lblImagePath, btnImagesPath, edtImagesPath, lblPort, edtPort, lblMinTime, edtMinTime, lblServerIP, lblNoNetwork, cmbServerIP, lstEvents, imgLast_1, imgLast_2, imgLast_3, btnAbout, btnControl, lblStatus, imgSearching

Global Img_wndMain_0, Img_wndMain_1, Img_wndMain_2

UsePNGImageDecoder()

Img_wndMain_0 = LoadImage(#PB_Any,"resources\logo.png")
Img_wndMain_1 = LoadImage(#PB_Any,"resources\searching.gif")
Img_wndMain_2 = LoadImage(#PB_Any,"resources\placeholder.png")

Enumeration FormFont
  #Font_wndMain_0
  #Font_wndMain_1
  #Font_wndMain_2
  #Font_wndMain_3
EndEnumeration

LoadFont(#Font_wndMain_0,"Consolas", 24, #PB_Font_Bold)
LoadFont(#Font_wndMain_1,"Consolas", 12, #PB_Font_Bold)
LoadFont(#Font_wndMain_2,"Consolas", 14, #PB_Font_Bold)
LoadFont(#Font_wndMain_3,"Consolas", 12, #PB_Font_Bold | #PB_Font_Italic)

Declare ChangeMinTime(EventType)
Declare ChangePort(EventType)
Declare GetImagesPath(EventType)
Declare DisplayAboutBox(EventType)
Declare ToggleImageServer(EventType)
Declare ChangeServerIP(EventType)

Procedure OpenwndMain(x = 0, y = 0, width = 800, height = 600)
  wndMain = OpenWindow(#PB_Any, x, y, width, height, "", #PB_Window_SystemMenu | #PB_Window_MinimizeGadget)
  lblTitle = TextGadget(#PB_Any, 10, 10, 400, 40, "ByteCave Image Server")
  SetGadgetFont(lblTitle, FontID(#Font_wndMain_0))
  lblImagePath = TextGadget(#PB_Any, 20, 70, 120, 20, "Images Folder")
  GadgetToolTip(lblImagePath, "Path to images. Images will be selected recursively.")
  SetGadgetFont(lblImagePath, FontID(#Font_wndMain_1))
  btnImagesPath = ButtonGadget(#PB_Any, 740, 90, 40, 25, "...")
  GadgetToolTip(btnImagesPath, "Select images folder")
  edtImagesPath = StringGadget(#PB_Any, 20, 90, 720, 25, "Press button to right to select path to images", #PB_String_ReadOnly)
  GadgetToolTip(edtImagesPath, "Path to images. Images will be selected recursively.")
  SetGadgetColor(edtImagesPath, #PB_Gadget_FrontColor,RGB(128,128,128))
  lblPort = TextGadget(#PB_Any, 20, 130, 100, 20, "HTTP Port:")
  GadgetToolTip(lblPort, "Port for image server to run on.")
  SetGadgetFont(lblPort, FontID(#Font_wndMain_1))
  edtPort = StringGadget(#PB_Any, 120, 130, 60, 25, "80", #PB_String_Numeric)
  GadgetToolTip(edtPort, "Port for image server to run on.")
  SetGadgetColor(edtPort, #PB_Gadget_FrontColor,RGB(0,0,0))
  lblMinTime = TextGadget(#PB_Any, 200, 130, 270, 20, "Minimum time between images:")
  SetGadgetFont(lblMinTime, FontID(#Font_wndMain_1))
  edtMinTime = StringGadget(#PB_Any, 460, 130, 60, 25, "2000", #PB_String_Numeric)
  GadgetToolTip(edtMinTime, "Throttle requests from same client.")
  SetGadgetColor(edtMinTime, #PB_Gadget_FrontColor,RGB(0,0,0))
  lblServerIP = TextGadget(#PB_Any, 540, 130, 100, 20, "Server IP:")
  SetGadgetFont(lblServerIP, FontID(#Font_wndMain_1))
  lblNoNetwork = TextGadget(#PB_Any, 640, 130, 140, 25, "NO NETWORK", #PB_Text_Center)
  SetGadgetColor(lblNoNetwork, #PB_Gadget_FrontColor,RGB(255,0,0))
  SetGadgetFont(lblNoNetwork, FontID(#Font_wndMain_2))
  cmbServerIP = ComboBoxGadget(#PB_Any, 640, 130, 140, 25)
  GadgetToolTip(cmbServerIP, "Select local IP address where image server is available.")
  lstEvents = ListViewGadget(#PB_Any, 20, 220, 620, 350)
  SetGadgetColor(lstEvents, #PB_Gadget_FrontColor,RGB(0,0,0))
  imgLast_1 = ImageGadget(#PB_Any, 670, 220, 110, 110, ImageID(Img_wndMain_2), #PB_Image_Border)
  imgLast_2 = ImageGadget(#PB_Any, 670, 340, 110, 110, ImageID(Img_wndMain_2), #PB_Image_Border)
  imgLast_3 = ImageGadget(#PB_Any, 670, 460, 110, 110, ImageID(Img_wndMain_2), #PB_Image_Border)
  btnAbout = ButtonImageGadget(#PB_Any, 660, 10, 128, 70, ImageID(Img_wndMain_0))
  GadgetToolTip(btnAbout, "Click to learn more about ByteCave Image Server")
  btnControl = ButtonGadget(#PB_Any, 670, 170, 110, 40, "START", #PB_Button_Toggle)
  GadgetToolTip(btnControl, "Toggle to start/stop image server.")
  SetGadgetFont(btnControl, FontID(#Font_wndMain_2))
  DisableGadget(btnControl, 1)
  lblStatus = TextGadget(#PB_Any, 20, 180, 620, 20, "Start server to see connection string for clients.")
  SetGadgetFont(lblStatus, FontID(#Font_wndMain_3))
  imgSearching = ImageGadget(#PB_Any, 700, 158, 45, 60, ImageID(Img_wndMain_1))
EndProcedure

Procedure wndMain_Events(event)
  Select event
    Case #PB_Event_CloseWindow
      ProcedureReturn #False

    Case #PB_Event_Menu
      Select EventMenu()
      EndSelect

    Case #PB_Event_Gadget
      Select EventGadget()
        Case btnImagesPath
          GetImagesPath(EventType())          
        Case edtPort
          ChangePort(EventType())          
        Case edtMinTime
          ChangeMinTime(EventType())          
        Case cmbServerIP
          ChangeServerIP(EventType())          
        Case btnAbout
          DisplayAboutBox(EventType())          
        Case btnControl
          ToggleImageServer(EventType())          
      EndSelect
  EndSelect
  ProcedureReturn #True
EndProcedure


; IDE Options = PureBasic 5.71 LTS (Windows - x64)
; CursorPosition = 37
; FirstLine = 17
; Folding = -
; EnableXP